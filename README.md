# 智慧数据库Agent

## 目录

- [概述](#概述)
- [功能特性](#功能特性)
- [架构设计](#架构设计)
  - [智能体架构](#智能体架构)
  - [工具调用与MCP集成](#工具调用与mcp集成)
  - [数据库实时探针](#数据库实时探针)
  - [SQL优化自动化工作流](#sql优化自动化工作流)
  - [空间分析与健康报告生成](#空间分析与健康报告生成)
  - [知识库与经验复用](#知识库与经验复用)
  - [安全保障及备份管理](#安全保障及备份管理)
- [技术栈](#技术栈)
- [安装与运行](#安装与运行)
- [贡献](#贡献)
- [许可证](#许可证)

## 概述

智慧数据库Agent 是一个基于 **LangChain4j** 和 **LangGraph4j** 构建的多智能体协作框架，旨在实现自然语言操作数据库、异常诊断、SQL优化与健康报告自动生成等功能。该系统通过智能化手段提升数据库运维效率，减少重复性工作，并保障数据安全与高可用性。

## 功能特性

- 自然语言查询数据库
- 数据库异常自动诊断
- SQL优化建议与验证
- 健康报告自动生成
- 知识库沉淀与经验复用

## 架构设计

### 智能体架构

基于 **LangChain4j** 和 **LangGraph4j** 构建 ReActAgent 与 Multi-Agent框架，将“思考、决策、执行”定义为节点，支持多分支控制与并行任务调度。通过 **HumanAsTool** 让用户在关键节点介入干预，确保操作安全可控。

### 工具调用与MCP集成

封装 **LangChain4j Tool**，集成数据库探针、SQL执行器、监控查询等功能，实现智能体对工具和 **MCP工具** 的自主调用。在对话中自动完成问题排查、数据查询、操作执行与结果分析。

### 数据库实时探针

使用 **XXL-job** 定时任务采集用户实例 CPU、内存等系统指标，并通过 **Kafka** 发送到主应用记录。主应用收集连接数、QPS、SQL执行次数等数据库指标，巡检 **慢SQL、事务阻塞、死锁** 等异常，发现潜在风险触发告警。

### SQL优化自动化工作流

利用 **LangGraph4j** 搭建四阶段优化流程：“**信息检索 → 优化建议 → 验证执行 → 结果总结**”。智能体自动获取执行计划与表结构，生成优化建议及改写后的 SQL，并在 **沙箱环境** 中验证效果。

### 空间分析与健康报告生成

融合实例指标与异常检测结果，进行数据库空间使用的可视化分析，并通过 **预定义模板** 与 **自然语言生成** 能力自动生成结构化的数据库健康报告。

### 知识库与经验复用

用户上传的历史工单与智能体诊断优化结论沉淀为知识库，结合 **RAG检索增强技术**，LLM自动检索相似案例，复用历史优化经验，减少重复性分析工作，实现持续进化的能力。

### 安全保障及备份管理

实施权限分级、变更操作留痕与 **SQL注入防护（预编译 + 输入过滤）**，采用“**日增备 + 周全备**”策略，备份数据 **加密存储、异地留存30天**。
## 技术栈

- **LangChain4j**: 多智能体协作框架
- **LangGraph4j**: 图形化智能体设计工具
- **Kafka**: 高吞吐消息队列
- **XXL-job**: 分布式定时任务调度平台
- **Redis**: 缓存与状态管理
- **MySQL**: 数据库管理系统
- **Spring Boot**: 后端服务开发框架
## 贡献

欢迎贡献代码！请遵循以下步骤：

1. Fork 仓库
2. 创建新分支 (`git checkout -b feature-branch`)
3. 提交更改 (`git commit -am 'Add new feature'`)
4. 推送分支 (`git push origin feature-branch`)
5. 提交 Pull Request

## 许可证

本项目采用 MIT 许可证，请参阅 LICENSE 文件获取更多信息。

